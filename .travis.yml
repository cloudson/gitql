language: go

os:
- linux
- osx
- windows

dist: xenial

env:
- PATH="/usr/local/opt/ccache/libexec:/usr/lib/ccache:$PATH"

addons:
  apt:
    packages:
    - ninja-build
    - pkg-config
  homebrew:
    packages:
    - ninja
    - ccache

go:  
- "1.12.x"

cache: ccache

before_script: 
- choco install -y make cmake ninja || true
- go get -d -v
- ( cd $(go list -f '{{ .Dir }}' github.com/libgit2/git2go) && $OLDPWD/prepare.sh )

script: 
- env
